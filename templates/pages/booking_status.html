{{define "booking_status.html"}}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Title}} | Meet When</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body class="public-page booking-status-page">
    <div class="booking-status-container">
        {{if .Data.Rescheduled}}
        <div class="alert alert-success">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
            Your booking has been successfully rescheduled!
        </div>
        {{end}}
        {{if .Data.Cancelled}}
        <div class="alert alert-info">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="8" x2="12" y2="12"/>
                <line x1="12" y1="16" x2="12.01" y2="16"/>
            </svg>
            Your booking has been cancelled.
        </div>
        {{end}}

        <div class="status-header">
            {{if eq .Data.Booking.Status "pending"}}
            <div class="status-icon pending">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <polyline points="12 6 12 12 16 14"/>
                </svg>
            </div>
            <span class="status-badge pending">Awaiting Approval</span>
            <h1>Booking Request Sent</h1>
            <p>Your booking request has been sent to <strong>{{.Host.Name}}</strong>. They will review your request and you'll receive an email once it's confirmed or declined.</p>
            {{else if eq .Data.Booking.Status "confirmed"}}
            <div class="status-icon confirmed">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <polyline points="20 6 9 17 4 12"/>
                </svg>
            </div>
            <span class="status-badge confirmed">Confirmed</span>
            <h1>You're All Set!</h1>
            <p>Your meeting with <strong>{{.Host.Name}}</strong> is confirmed. We've sent you a confirmation email with all the details.</p>
            {{else if eq .Data.Booking.Status "cancelled"}}
            <div class="status-icon cancelled">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="15" y1="9" x2="9" y2="15"/>
                    <line x1="9" y1="9" x2="15" y2="15"/>
                </svg>
            </div>
            <span class="status-badge cancelled">Cancelled</span>
            <h1>Booking Cancelled</h1>
            <p>This booking has been cancelled.</p>
            {{else if eq .Data.Booking.Status "rejected"}}
            <div class="status-icon rejected">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="15" y1="9" x2="9" y2="15"/>
                    <line x1="9" y1="9" x2="15" y2="15"/>
                </svg>
            </div>
            <span class="status-badge rejected">Declined</span>
            <h1>Booking Declined</h1>
            <p>Unfortunately, this booking request was not approved by the host.</p>
            {{end}}
        </div>

        {{if eq .Data.Booking.Status "pending"}}
        <div class="pending-notice">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="8" x2="12" y2="12"/>
                <line x1="12" y1="16" x2="12.01" y2="16"/>
            </svg>
            <span>The host needs to approve this booking before it's confirmed.</span>
        </div>
        {{end}}

        <div class="booking-card">
            <div class="booking-card-header">
                <h2>{{.Data.Template.Name}}</h2>
                <p>with {{.Host.Name}}</p>
            </div>
            <div class="booking-details">
                <div class="detail-row">
                    <div class="detail-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                            <line x1="16" y1="2" x2="16" y2="6"/>
                            <line x1="8" y1="2" x2="8" y2="6"/>
                            <line x1="3" y1="10" x2="21" y2="10"/>
                        </svg>
                    </div>
                    <div class="detail-content">
                        <span class="detail-label">Date & Time</span>
                        <span class="detail-value">{{formatDateTime .Data.Booking.StartTime}}</span>
                    </div>
                </div>

                <div class="detail-row">
                    <div class="detail-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <polyline points="12 6 12 12 16 14"/>
                        </svg>
                    </div>
                    <div class="detail-content">
                        <span class="detail-label">Duration</span>
                        <span class="detail-value">{{.Data.Booking.Duration}} minutes</span>
                    </div>
                </div>

                <div class="detail-row">
                    <div class="detail-icon">
                        {{if eq .Data.Template.LocationType "phone"}}
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                        </svg>
                        {{else if or (eq .Data.Template.LocationType "google_meet") (eq .Data.Template.LocationType "zoom")}}
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="23 7 16 12 23 17 23 7"/>
                            <rect x="1" y="5" width="15" height="14" rx="2" ry="2"/>
                        </svg>
                        {{else}}
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                            <circle cx="12" cy="10" r="3"/>
                        </svg>
                        {{end}}
                    </div>
                    <div class="detail-content">
                        <span class="detail-label">Location</span>
                        <span class="detail-value">
                            {{if eq .Data.Template.LocationType "phone"}}
                                {{if .Data.Template.CustomLocation}}
                                Call {{.Data.Template.CustomLocation}}
                                {{else}}
                                Phone Call
                                {{end}}
                            {{else if eq .Data.Template.LocationType "custom"}}
                                {{.Data.Template.CustomLocation}}
                            {{else if .Data.Booking.ConferenceLink}}
                                {{if eq .Data.Booking.Status "confirmed"}}
                                <a href="{{.Data.Booking.ConferenceLink}}" target="_blank">
                                    {{if eq .Data.Template.LocationType "google_meet"}}Join Google Meet{{else if eq .Data.Template.LocationType "zoom"}}Join Zoom Meeting{{else}}Join Meeting{{end}}
                                </a>
                                {{else}}
                                {{if eq .Data.Template.LocationType "google_meet"}}Google Meet{{else if eq .Data.Template.LocationType "zoom"}}Zoom{{else}}Video Call{{end}} (link available after confirmation)
                                {{end}}
                            {{else}}
                                {{if eq .Data.Template.LocationType "google_meet"}}Google Meet{{else if eq .Data.Template.LocationType "zoom"}}Zoom{{else}}To be determined{{end}}
                                {{if eq .Data.Booking.Status "confirmed"}}
                                (check your confirmation email)
                                {{else}}
                                (link available after confirmation)
                                {{end}}
                            {{end}}
                        </span>
                    </div>
                </div>

                <div class="detail-row">
                    <div class="detail-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                            <circle cx="12" cy="7" r="4"/>
                        </svg>
                    </div>
                    <div class="detail-content">
                        <span class="detail-label">Host</span>
                        <span class="detail-value">{{.Host.Name}}</span>
                    </div>
                </div>
            </div>
        </div>

        {{if or (eq .Data.Booking.Status "pending") (eq .Data.Booking.Status "confirmed")}}
        <div class="primary-actions">
            <a href="/booking/{{.Data.Booking.Token}}/calendar.ics" class="btn btn-primary" download>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                    <line x1="16" y1="2" x2="16" y2="6"/>
                    <line x1="8" y1="2" x2="8" y2="6"/>
                    <line x1="3" y1="10" x2="21" y2="10"/>
                    <line x1="12" y1="14" x2="12" y2="18"/>
                    <line x1="10" y1="16" x2="14" y2="16"/>
                </svg>
                Add to Calendar
            </a>
        </div>

        <div class="secondary-actions">
            <a href="/booking/{{.Data.Booking.Token}}/reschedule" class="btn btn-secondary">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                    <polyline points="23 4 23 10 17 10"/>
                    <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
                </svg>
                Reschedule
            </a>
            <form action="/booking/{{.Data.Booking.Token}}/cancel" method="POST">
                <button type="submit" class="btn btn-secondary btn-danger" onclick="return confirm('Are you sure you want to cancel this booking?')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="15" y1="9" x2="9" y2="15"/>
                        <line x1="9" y1="9" x2="15" y2="15"/>
                    </svg>
                    Cancel
                </button>
            </form>
        </div>

        <div class="signup-prompt">
            <h3>Need your own scheduling page?</h3>
            <p>Create a free MeetWhen account and let others book time with you.</p>
            <a href="/signup/track?ref=booking:{{.Data.Booking.Token}}" class="btn btn-accent">
                Get Started Free
            </a>
        </div>
        {{end}}

        <a href="/m/{{.Tenant.Slug}}/{{.Host.Slug}}" class="back-link">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                <line x1="19" y1="12" x2="5" y2="12"/>
                <polyline points="12 19 5 12 12 5"/>
            </svg>
            Book another meeting
        </a>
    </div>
</body>
</html>
{{end}}

{{define "dashboard_agenda.html"}}
{{template "dashboard" .}}
{{end}}

{{define "content"}}
<div class="page-header">
    <div>
        <h1 class="page-title">Agenda</h1>
        <p class="page-subtitle">
            {{if eq .Data.View "week"}}
            Week of {{formatDate (index .Data.DayGroups 0).Date}}
            {{else}}
            {{formatDate .Data.Today}}
            {{end}}
        </p>
    </div>
</div>

<div class="filter-bar">
    <div class="filter-tabs">
        <a href="/dashboard/agenda" class="filter-tab {{if eq .Data.View "today"}}active{{end}}">Today</a>
        <a href="/dashboard/agenda?view=week" class="filter-tab {{if eq .Data.View "week"}}active{{end}}">This Week</a>
    </div>
</div>

{{if eq .Data.View "week"}}
<!-- Week view - events grouped by day -->
<div class="agenda-week">
    {{range .Data.DayGroups}}
    <div class="agenda-day-card">
        <div class="agenda-day-header">
            <span class="day-name">{{.Date.Weekday}}</span>
            <span class="day-date">{{formatDate .Date}}</span>
        </div>
        {{if .Events}}
        <div class="agenda-events">
            {{range .Events}}
            <div class="agenda-event {{if .IsAllDay}}all-day{{end}}">
                <div class="event-time-col">
                    {{if .IsAllDay}}
                    <span class="all-day-badge">All Day</span>
                    {{else}}
                    <span class="event-time">{{formatTime .Start}}</span>
                    <span class="event-time-end">{{formatTime .End}}</span>
                    {{end}}
                </div>
                <div class="event-details">
                    <span class="event-title">{{if .Title}}{{.Title}}{{else}}(No title){{end}}</span>
                    {{if not .IsAllDay}}
                    <span class="event-duration">{{duration .Start .End}}</span>
                    {{end}}
                </div>
                <span class="event-calendar">{{.CalendarName}}</span>
            </div>
            {{end}}
        </div>
        {{else}}
        <div class="agenda-no-events">No events</div>
        {{end}}
    </div>
    {{end}}
</div>
{{else}}
<!-- Today view -->
{{if .Data.Events}}
<div class="table-container">
    <table class="table agenda-table">
        <thead>
            <tr>
                <th>Time</th>
                <th>Event</th>
                <th>Duration</th>
                <th>Calendar</th>
            </tr>
        </thead>
        <tbody>
            {{range .Data.Events}}
            <tr class="{{if .IsAllDay}}all-day-row{{end}}">
                <td class="event-time-cell">
                    {{if .IsAllDay}}
                    <span class="all-day-badge">All Day</span>
                    {{else}}
                    <div class="event-times">
                        <span class="event-time">{{formatTime .Start}}</span>
                        <span class="event-time-separator">-</span>
                        <span class="event-time">{{formatTime .End}}</span>
                    </div>
                    {{end}}
                </td>
                <td class="event-title-cell">
                    {{if .Title}}{{.Title}}{{else}}<em class="no-title">(No title)</em>{{end}}
                </td>
                <td class="event-duration-cell">
                    {{if not .IsAllDay}}
                    {{duration .Start .End}}
                    {{end}}
                </td>
                <td>
                    <span class="calendar-badge">{{.CalendarName}}</span>
                </td>
            </tr>
            {{end}}
        </tbody>
    </table>
</div>
{{else}}
<div class="empty-state-card">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
        <line x1="16" y1="2" x2="16" y2="6"/>
        <line x1="8" y1="2" x2="8" y2="6"/>
        <line x1="3" y1="10" x2="21" y2="10"/>
    </svg>
    <h3>No events today</h3>
    <p>Your schedule is clear for today. Enjoy your free time!</p>
</div>
{{end}}
{{end}}
{{end}}
